let R, G, B; self.onmessage = (e => { const a = e.data.key; if (e.data.R && e.data.G && e.data.B) R = new Uint8ClampedArray(e.data.R), G = new Uint8ClampedArray(e.data.G), B = new Uint8ClampedArray(e.data.B), self.postMessage({ result: !0 }); else { const t = new Uint8ClampedArray(e.data.img), l = new Uint8ClampedArray(t), s = e.data.width, r = e.data.height; try { for (let e = 0; e < r; ++e)for (let a = 0; a < s; ++a) { let r = 4 * a + e * s * 4; l[r] = R[t[r]], l[r + 1] = G[t[r + 1]], l[r + 2] = B[t[r + 2]], l[r + 3] = t[r + 3] } self.postMessage({ filter: l.buffer, width: s, height: r, key: a }, [l.buffer]) } catch (e) { console.warn(e), self.postMessage({ filter: null, key: a }) } } });